<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo.jpg">
  <link rel="mask-icon" href="/images/logo.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"luyanan.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="4. Elasticsearch之检索4. 检索4.1 样本测试数据准备一份顾客银行账户信息的虚构的JSON  文档样本,每个文档下面都用下列的schema(模式) 12345678910111213&amp;#123;	&quot;account_number&quot;: 1,	&quot;balance&quot;: 39225,	&quot;firstname&quot;: &quot;Amber">
<meta property="og:type" content="article">
<meta property="og:title" content="Elasticsearch之检索">
<meta property="og:url" content="http://luyanan.com/Elasticsearch%E4%B9%8B%E6%A3%80%E7%B4%A2/index.html">
<meta property="og:site_name" content="程序员报社">
<meta property="og:description" content="4. Elasticsearch之检索4. 检索4.1 样本测试数据准备一份顾客银行账户信息的虚构的JSON  文档样本,每个文档下面都用下列的schema(模式) 12345678910111213&amp;#123;	&quot;account_number&quot;: 1,	&quot;balance&quot;: 39225,	&quot;firstname&quot;: &quot;Amber">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-03-02T05:51:37.573Z">
<meta property="article:modified_time" content="2021-03-02T05:42:51.678Z">
<meta property="article:author" content="luyanan">
<meta property="article:tag" content="Python, Rust, C++, Go, 爬虫, 深度学习, 服务研发, 对象存储">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://luyanan.com/Elasticsearch%E4%B9%8B%E6%A3%80%E7%B4%A2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Elasticsearch之检索 | 程序员报社</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="程序员报社" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">程序员报社</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">程序员报社</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://luyanan.com/Elasticsearch%E4%B9%8B%E6%A3%80%E7%B4%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="luyanan">
      <meta itemprop="description" content="程序员报社">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="程序员报社">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Elasticsearch之检索
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2021-03-02 13:51:37 / 修改时间：13:42:51" itemprop="dateCreated datePublished" datetime="2021-03-02T13:51:37+08:00">2021-03-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/elasticsearch/" itemprop="url" rel="index"><span itemprop="name">elasticsearch</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="4-Elasticsearch之检索"><a href="#4-Elasticsearch之检索" class="headerlink" title="4. Elasticsearch之检索"></a>4. Elasticsearch之检索</h1><h2 id="4-检索"><a href="#4-检索" class="headerlink" title="4. 检索"></a>4. 检索</h2><h3 id="4-1-样本测试数据"><a href="#4-1-样本测试数据" class="headerlink" title="4.1 样本测试数据"></a>4.1 样本测试数据</h3><p>准备一份顾客银行账户信息的虚构的<code>JSON</code>  文档样本,每个文档下面都用下列的<code>schema</code>(模式)</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">&quot;account_number&quot;</span>: <span class="number">1</span>,</span><br><span class="line">	<span class="attr">&quot;balance&quot;</span>: <span class="number">39225</span>,</span><br><span class="line">	<span class="attr">&quot;firstname&quot;</span>: <span class="string">&quot;Amber&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;lastname&quot;</span>: <span class="string">&quot;Duke&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;age&quot;</span>: <span class="number">32</span>,</span><br><span class="line">	<span class="attr">&quot;gender&quot;</span>: <span class="string">&quot;M&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;address&quot;</span>: <span class="string">&quot;880 Holmes Lane&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;employer&quot;</span>: <span class="string">&quot;Pyrami&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;email&quot;</span>: <span class="string">&quot;amberduke@pyrami.com&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;city&quot;</span>: <span class="string">&quot;Brogan&quot;</span>,</span><br><span class="line">	<span class="attr">&quot;state&quot;</span>: <span class="string">&quot;IL&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>从 <code>[https://github.com/elastic/elasticsearch/blob/master/docs/src/test/resources/accounts.json] </code>  导入测试数据</p>
<p><code>POST bank/account/_bulk</code></p>
<h3 id="4-2-检索"><a href="#4-2-检索" class="headerlink" title="4.2 检索"></a>4.2 检索</h3><h4 id="4-2-1-search-api"><a href="#4-2-1-search-api" class="headerlink" title="4.2.1 search api"></a>4.2.1 <code>search api</code></h4><p><code>ES</code> 支持两种基本方式检索</p>
<ul>
<li>通过<code>REST request uri</code>发送搜索参数(uri+搜索参数)</li>
<li>通过<code>REST request body</code>  来发送参数(uri+请求体)</li>
</ul>
<p>信息检索</p>
<blockquote>
<p> 一切检索从<code>_search</code>开始</p>
</blockquote>
<ul>
<li><p><code>GET /bank/_search</code>    </p>
<blockquote>
<p>检索<code>bank</code> 下所有信息,包括<code>type</code>和<code>docs</code></p>
</blockquote>
</li>
<li><p><code>GET</code> <code>bank/_search?q=*&amp;sort=account_number:asc</code> </p>
<blockquote>
<p> 请求参数方式检索</p>
</blockquote>
<p>返回结果: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">887</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">1000</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;0&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">0</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">16623</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Bradshaw&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Mckenzie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">29</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;F&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;244 Columbus Place&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Euron&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;bradshawmckenzie@euron.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Hobucken&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;CO&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">0</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">39225</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Amber&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Duke&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">32</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;880 Holmes Lane&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Pyrami&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;amberduke@pyrami.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Brogan&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;IL&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">1</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;2&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">28838</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Roberta&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Bender&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">22</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;F&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;560 Kingsway Place&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Chillium&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;robertabender@chillium.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Bennett&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;LA&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">2</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;3&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">3</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">44947</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Levine&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Burks&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">26</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;F&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;328 Wilson Avenue&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Amtap&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;levineburks@amtap.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Cochranville&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;HI&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">3</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;4&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">4</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">27658</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Rodriquez&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Flores&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">31</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;F&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;986 Wyckoff Avenue&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Tourmania&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;rodriquezflores@tourmania.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Eastvale&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;HI&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">4</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;5&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">5</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">29342</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Leola&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Stewart&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">30</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;F&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;311 Elm Place&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Diginetic&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;leolastewart@diginetic.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Fairview&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;NJ&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">5</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;6&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">6</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">5686</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Hattie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Bond&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">36</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;671 Bristol Street&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Netagy&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;hattiebond@netagy.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Dante&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;TN&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">6</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;7&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">7</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">39121</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Levy&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Richard&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">22</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;820 Logan Street&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Teraprene&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;levyrichard@teraprene.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Shrewsbury&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;MO&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">7</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;8&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">8</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">48868</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Jan&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Burns&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">35</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;699 Visitation Place&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Glasstep&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;janburns@glasstep.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Wakulla&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;AZ&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">8</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;9&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">9</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">24776</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Opal&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Meadows&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">39</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;963 Neptune Avenue&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Cedward&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;opalmeadows@cedward.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Olney&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;OH&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">9</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>响应结果解释: </p>
<ul>
<li><code>took</code>: <code>es</code> 执行搜索的时间(毫秒)</li>
<li><code>time_out</code>: 告诉我们搜索是否超时</li>
<li><code>_shards</code>: 告诉我们多少个分片被搜索了,以及统计了成功/失败的搜索分片</li>
<li><code>hits</code>: 搜索结果</li>
<li><code>hits.total</code>: 搜索结果总条数</li>
<li><code>hits.hits</code>: 实际的搜索结果(数组), 默认为前10 的文档 </li>
<li><code>sort</code>: 结果的排序key(键), 没有则按照 <code>scort</code> 排序</li>
<li><code>score</code> 和<code>max_score</code> : 相关性得分和最高得分(全文检索用)</li>
</ul>
<p>详细的字段信息，参照： <a target="_blank" rel="noopener" href="https://_www.elastic.co_guide_en_elasticsearch_reference_current_getting-started-search/">https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started-search.html</a></p>
</li>
</ul>
<h3 id="4-3-Query-DSL"><a href="#4-3-Query-DSL" class="headerlink" title="4.3 Query DSL"></a>4.3 <code>Query DSL</code></h3><h4 id="4-3-1-基本语法格式"><a href="#4-3-1-基本语法格式" class="headerlink" title="4.3.1 基本语法格式"></a>4.3.1 基本语法格式</h4><p><code>Elasticsearch</code>  提供了一个可以执行查询的<code>json</code> 风格的<code>DSL</code>, 这个被称为<code>Query DSL</code>, 该查询语句非常全面,一个查询语句的典型结构: </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QUERY_NAME:&#123;</span><br><span class="line">   ARGUMENT:VALUE,</span><br><span class="line">   ARGUMENT:VALUE,...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果针对某个字段,那么它的结构如下: </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  QUERY_NAME:&#123;</span><br><span class="line">     FIELD_NAME:&#123;</span><br><span class="line">       ARGUMENT:VALUE,</span><br><span class="line">       ARGUMENT:VALUE,...</span><br><span class="line">      &#125;   </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match_all&quot;</span>: &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;from&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;size&quot;</span>: <span class="number">5</span>,</span><br><span class="line">  <span class="attr">&quot;sort&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;account_number&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;order&quot;</span>: <span class="string">&quot;desc&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>query</code> 定义了如何查询</p>
<ul>
<li><code>match_all</code> : 查询类型(代表查询所有的数据), <code>es</code>中可以在<code>query</code> 中组合非常多的查询类型来完成复杂查询</li>
<li>除 了<code>query</code> 参数之后,我们也可以传递其他的参数以改变查询的结果,比如<code>sort</code>,<code>size</code></li>
<li><code>form</code>+<code>szie</code> 限定, 完成分页功能</li>
<li><code>sort</code>排序,多字段排序,会在前序字段相等时后续字段内部排序,否则以前序为准</li>
</ul>
<h4 id="4-3-2-返回部分字段"><a href="#4-3-2-返回部分字段" class="headerlink" title="4.3.2  返回部分字段"></a>4.3.2  返回部分字段</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match_all&quot;</span>: &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;from&quot;</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">&quot;size&quot;</span>: <span class="number">5</span>,</span><br><span class="line">  <span class="attr">&quot;sort&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;account_number&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;order&quot;</span>: <span class="string">&quot;desc&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;_source&quot;</span>: [<span class="string">&quot;balance&quot;</span>,<span class="string">&quot;firstname&quot;</span>]</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回结果: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">221</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">1000</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;999&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Dorothy&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">6087</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">999</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;998&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Letha&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">16869</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">998</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;997&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Combs&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">25311</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">997</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;996&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Andrews&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">17541</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">996</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;995&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Phelps&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">21153</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sort&quot;</span> : [</span><br><span class="line">          <span class="number">995</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="4-3-3-match-匹配查询"><a href="#4-3-3-match-匹配查询" class="headerlink" title="4.3.3 match 匹配查询"></a>4.3.3 <code>match</code> 匹配查询</h4><ul>
<li>基本类型(非字符串), 精切控制</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;account_number&quot;</span>: <span class="string">&quot;20&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>match</code> 返回 account_number=20的数据</p>
<p>返回结果; </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">774</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">1.0</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;20&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">1.0</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">20</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">16418</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Elinor&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Ratliff&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">36</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;282 Kings Place&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Scentric&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;elinorratliff@scentric.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Ribera&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;WA&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>字符串: 全文检索</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;kings&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>全文检索,最后会按照评分进行排序,会对检索条件进行分词匹配</p>
<p>查询结果:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">790</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">2</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">6.095661</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;20&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.095661</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">20</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">16418</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Elinor&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Ratliff&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">36</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;282 Kings Place&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Scentric&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;elinorratliff@scentric.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Ribera&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;WA&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;722&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.095661</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">722</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">27256</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Roberts&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Beasley&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">34</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;F&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;305 Kings Hwy&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Quintity&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;robertsbeasley@quintity.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Hayden&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;PA&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="4-3-4-match-phrase-短句匹配"><a href="#4-3-4-match-phrase-短句匹配" class="headerlink" title="4.3.4 match_phrase 短句匹配"></a>4.3.4 <code>match_phrase</code> 短句匹配</h4><p>将需要匹配的值当成一整个单词(不分词) 进行检索</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match_phrase&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;mill road&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看 <code>address</code> 中包含 <code>mill road</code>的所有记录, 并且给出相关性得分.</p>
<p>返回结果: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">6278</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">8.991257</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;970&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">8.991257</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">970</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">19648</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Forbes&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Wallace&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;990 Mill Road&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Pheast&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;forbeswallace@pheast.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Lopezo&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;AK&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>match</code>  和<code>match_phrase</code> 的区别,观察如下例子: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match_phrase&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;990 Mill&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回结果:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">48</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">10.919691</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;970&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">10.919691</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">970</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">19648</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Forbes&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Wallace&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;990 Mill Road&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Pheast&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;forbeswallace@pheast.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Lopezo&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;AK&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>使用<code>match</code> 的<code>keyword</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;address.keyword&quot;</span>: <span class="string">&quot;990 Mill&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看结果, 一条也没有匹配到</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">34</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [ ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>修改匹配条件为: <code>990 Mill Road</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;address.keyword&quot;</span>: <span class="string">&quot;990 Mill Road&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查询出来一条数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">133</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">6.685111</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;970&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.685111</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">970</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">19648</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Forbes&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Wallace&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;990 Mill Road&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Pheast&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;forbeswallace@pheast.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Lopezo&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;AK&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>文本字段的匹配,使用<code>keyword</code>, 匹配的条件就是要显示字段的全部值,要进行精确匹配,<code>match_phrase</code> 是做短语匹配的,只要是文本中包含匹配条件,就能匹配到. </p>
<h4 id="4-3-5-multi-math-多字段匹配"><a href="#4-3-5-multi-math-多字段匹配" class="headerlink" title="4.3.5 multi_math 多字段匹配"></a>4.3.5 <code>multi_math</code> 多字段匹配</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;multi_match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;query&quot;</span>: <span class="string">&quot;mill&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;fields&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;state&quot;</span>,</span><br><span class="line">        <span class="string">&quot;address&quot;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>state</code> 或者<code>address</code> 中包含<code>mill</code>, 并且在查询的过程中 , 会对于查询条件进行分词. </p>
<p>查询结果:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">121</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">4</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">5.4598455</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;970&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">5.4598455</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">970</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">19648</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Forbes&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Wallace&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;990 Mill Road&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Pheast&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;forbeswallace@pheast.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Lopezo&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;AK&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;136&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">5.4598455</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">136</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">45801</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Winnie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Holland&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;198 Mill Lane&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Neteria&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;winnieholland@neteria.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Urie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;IL&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;345&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">5.4598455</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">345</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">9812</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Parker&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Hines&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;715 Mill Avenue&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Baluba&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;parkerhines@baluba.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Blackgum&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;KY&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;472&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">5.4598455</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">472</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">25571</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Lee&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Long&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">32</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;F&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;288 Mill Street&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Comverges&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;leelong@comverges.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Movico&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;MT&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="4-3-6-bool-用来做复合查询"><a href="#4-3-6-bool-用来做复合查询" class="headerlink" title="4.3.6  bool  用来做复合查询"></a>4.3.6  <code>bool</code>  用来做复合查询</h4><p>复合语句可以合并,任何其他查询语句,包括复合语句,这也就是意味着复合语句之间可以互相嵌套,可以表达非常复杂的逻辑. </p>
<h5 id="must-必须达到must-所列举的所有条件"><a href="#must-必须达到must-所列举的所有条件" class="headerlink" title="must:  必须达到must 所列举的所有条件"></a><code>must</code>:  必须达到<code>must</code> 所列举的所有条件</h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;must&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;mill&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;gender&quot;</span>: <span class="string">&quot;M&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 查看<code>address=mill</code> 和<code>gender=M</code>的数据</p>
<p>返回结果:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">21</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">3</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;970&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">970</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">19648</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Forbes&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Wallace&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;990 Mill Road&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Pheast&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;forbeswallace@pheast.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Lopezo&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;AK&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;136&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">136</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">45801</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Winnie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Holland&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;198 Mill Lane&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Neteria&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;winnieholland@neteria.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Urie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;IL&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;345&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">345</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">9812</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Parker&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Hines&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;715 Mill Avenue&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Baluba&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;parkerhines@baluba.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Blackgum&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;KY&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="must-not-必须不匹配must-not-所列举的所有条件"><a href="#must-not-必须不匹配must-not-所列举的所有条件" class="headerlink" title="must not 必须不匹配must not 所列举的所有条件"></a><code>must not</code> 必须不匹配<code>must not</code> 所列举的所有条件</h5><p>查询<code>gender=M</code> 并且<code>address =mill</code>的,但是<code>age!=38</code>的数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;must&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;mill&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;gender&quot;</span>: <span class="string">&quot;M&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;must_not&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;age&quot;</span>: <span class="string">&quot;30&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回结果: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">90</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">3</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;970&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">970</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">19648</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Forbes&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Wallace&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;990 Mill Road&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Pheast&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;forbeswallace@pheast.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Lopezo&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;AK&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;136&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">136</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">45801</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Winnie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Holland&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;198 Mill Lane&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Neteria&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;winnieholland@neteria.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Urie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;IL&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;345&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">345</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">9812</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Parker&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Hines&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;715 Mill Avenue&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Baluba&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;parkerhines@baluba.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Blackgum&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;KY&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="should-应该达到should-列举的条件-如果达到就会增加相关文档的评分-并不会改变查询的结果-如果query-中只有should-且只有一种匹配规则-那么should-的条件就会被作为默认匹配条件去改变查询结果"><a href="#should-应该达到should-列举的条件-如果达到就会增加相关文档的评分-并不会改变查询的结果-如果query-中只有should-且只有一种匹配规则-那么should-的条件就会被作为默认匹配条件去改变查询结果" class="headerlink" title="should  应该达到should   列举的条件,如果达到就会增加相关文档的评分, 并不会改变查询的结果, 如果query 中只有should   且只有一种匹配规则,那么should  的条件就会被作为默认匹配条件去改变查询结果"></a><code>should</code>  应该达到<code>should</code>   列举的条件,如果达到就会增加相关文档的评分, 并不会改变查询的结果, 如果<code>query</code> 中只有<code>should</code>   且只有一种匹配规则,那么<code>should</code>  的条件就会被作为默认匹配条件去改变查询结果</h5><p>例子: 匹配<code>lastName</code> 应该等于<code>Wallace</code>的数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;must&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;mill&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;gender&quot;</span>: <span class="string">&quot;M&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;must_not&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;age&quot;</span>: <span class="string">&quot;30&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;should&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;lastname&quot;</span>: <span class="string">&quot;Wallace&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>返回结果: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">18145</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">3</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">12.824207</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;970&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">12.824207</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">970</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">19648</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Forbes&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Wallace&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;990 Mill Road&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Pheast&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;forbeswallace@pheast.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Lopezo&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;AK&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;136&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">136</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">45801</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Winnie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Holland&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;198 Mill Lane&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Neteria&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;winnieholland@neteria.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Urie&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;IL&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;345&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">6.1390967</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">345</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">9812</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Parker&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Hines&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;715 Mill Avenue&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Baluba&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;parkerhines@baluba.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Blackgum&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;KY&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>能够看到相关度越高,得分也就越高</p>
<h4 id="4-3-7-Filter-结果过滤"><a href="#4-3-7-Filter-结果过滤" class="headerlink" title="4.3.7 Filter  结果过滤"></a>4.3.7 <code>Filter</code>  结果过滤</h4><p>并不是所有的查询都需要产生分数,特别是哪些仅用于<code>filter</code> 过滤的文档 . 为了不计算分数,<code>es</code> 会自动检查场景并且优化查询的执行</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bool&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;must&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;mill&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;filter&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;range&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;balance&quot;</span>: &#123;</span><br><span class="line">              <span class="attr">&quot;gte&quot;</span>: <span class="number">10000</span>,</span><br><span class="line">              <span class="attr">&quot;lte&quot;</span>: <span class="number">20000</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里先查询所有匹配<code>address=mill</code>的文档,然后再根据<code>10000&lt;=balance&lt;=20000</code>进行结果查询, 查询结果:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">66</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">1</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="number">5.4598455</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;_index&quot;</span> : <span class="string">&quot;bank&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_type&quot;</span> : <span class="string">&quot;account&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_id&quot;</span> : <span class="string">&quot;970&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;_score&quot;</span> : <span class="number">5.4598455</span>,</span><br><span class="line">        <span class="attr">&quot;_source&quot;</span> : &#123;</span><br><span class="line">          <span class="attr">&quot;account_number&quot;</span> : <span class="number">970</span>,</span><br><span class="line">          <span class="attr">&quot;balance&quot;</span> : <span class="number">19648</span>,</span><br><span class="line">          <span class="attr">&quot;firstname&quot;</span> : <span class="string">&quot;Forbes&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;lastname&quot;</span> : <span class="string">&quot;Wallace&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;age&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;gender&quot;</span> : <span class="string">&quot;M&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;address&quot;</span> : <span class="string">&quot;990 Mill Road&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;employer&quot;</span> : <span class="string">&quot;Pheast&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;email&quot;</span> : <span class="string">&quot;forbeswallace@pheast.com&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;city&quot;</span> : <span class="string">&quot;Lopezo&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;state&quot;</span> : <span class="string">&quot;AK&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Each <code>must</code>, <code>should</code>, and <code>must_not</code> element in a Boolean query is referred to as a query clause. How well a document meets the criteria in each <code>must</code> or <code>should</code> clause contributes to the document’s <em>relevance score</em>. The higher the score, the better the document matches your search criteria. By default, Elasticsearch returns documents ranked by these relevance scores.<br>在boolean查询中，<code>must</code>, <code>should</code> 和<code>must_not</code> 元素都被称为查询子句 。 文档是否符合每个“must”或“should”子句中的标准，决定了文档的“相关性得分”。  得分越高，文档越符合您的搜索条件。  默认情况下，Elasticsearch返回根据这些相关性得分排序的文档。<br>The criteria in a <code>must_not</code> clause is treated as a <em>filter</em>. It affects whether or not the document is included in the results, but does not contribute to how documents are scored. You can also explicitly specify arbitrary filters to include or exclude documents based on structured data.</p>
<p><code>“must_not”子句中的条件被视为“过滤器”。</code> 它影响文档是否包含在结果中，  但不影响文档的评分方式。  还可以显式地指定任意过滤器来包含或排除基于结构化数据的文档。</p>
<p><code>filter</code> 在使用过程中,并不会计算相关性得分</p>
<h4 id="4-3-8-term"><a href="#4-3-8-term" class="headerlink" title="4.3.8 term"></a>4.3.8 <code>term</code></h4><p>和<code>match</code> 一样,匹配某个属性的值,全文检索字段用<code>match</code>, 其他非<code>text</code>字段匹配用<code>term</code></p>
<blockquote>
<p>Avoid using the <code>term</code> query for <a target="_blank" rel="noopener" href="https://_www.elastic.co_guide_en_elasticsearch_reference_7.6_text/"><code>text</code></a> fields.<br>避免对文本字段使用“term”查询<br>By default, Elasticsearch changes the values of <code>text</code> fields as part of <a href="">analysis</a>. This can make finding exact matches for <code>text</code> field values difficult.<br>默认情况下，Elasticsearch作为<a href="">analysis</a>的一部分更改’ text ‘字段的值。这使得为“text”字段值寻找精确匹配变得困难。<br>To search <code>text</code> field values, use the match.<br>要搜索“text”字段值，请使用匹配。<br>[<a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/query-dsl-term-query.html]">https://www.elastic.co/guide/en/elasticsearch/reference/7.6/query-dsl-term-query.html]</a>(</p>
</blockquote>
<p>使用<code>term</code> 匹配查询</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;term&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;address&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;value&quot;</span>: <span class="string">&quot;mill Road&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回结果: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">26</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [ ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>一条也没有匹配到, 更换为<code>match</code>后, 就可以匹配到32个</p>
<p>也就是说, 全文检索字段用<code>match</code>, 其他非<code>text</code> 字段匹配用<code>match</code></p>
<h4 id="4-3-9-Aggregation-执行聚合"><a href="#4-3-9-Aggregation-执行聚合" class="headerlink" title="4.3.9 Aggregation 执行聚合"></a>4.3.9 <code>Aggregation</code> 执行聚合</h4><p>聚合提供了从数据中分组和提取数据的能力,最简单的聚合方法大致等于<code>SQL Group by</code>和<code>SQL</code>的聚合函数, 在<code>es</code>中,执行搜索返回<code>hits</code>( 命中结果), 并且同时返回聚合结果,把响应中所有的<code>hits</code>(命中结果)分隔开的能力, 这是非常强大并且有效的, 你可以执行查询和多个聚合,并且在一次使用中得到各自的(任何一个)返回结果,使用一次简介和简化的API 就可以避免网络往返. </p>
<p><code>size:0</code> 不显示搜索数据</p>
<p><code>aggs</code> 执行聚合,聚合语法如下: </p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;aggs&quot;:&#123;</span><br><span class="line">    &quot;aggs_name这次聚合的名字，方便展示在结果集中&quot;:&#123;</span><br><span class="line">        &quot;AGG_TYPE聚合的类型(avg,term,terms)&quot;:&#123;&#125;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;，</span><br></pre></td></tr></table></figure>

<h5 id="例子-搜索address-中包含mill-的所有人的年龄分布以及平均年龄-但是不显示这些人的详情"><a href="#例子-搜索address-中包含mill-的所有人的年龄分布以及平均年龄-但是不显示这些人的详情" class="headerlink" title="例子: 搜索address 中包含mill 的所有人的年龄分布以及平均年龄,但是不显示这些人的详情"></a>例子: 搜索<code>address</code> 中包含<code>mill</code> 的所有人的年龄分布以及平均年龄,但是不显示这些人的详情</h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;address&quot;</span>: <span class="string">&quot;mill&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;ageAgg&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;age&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;size&quot;</span>: <span class="number">10</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;ageAvg&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;avg&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;age&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;balanceAvg&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;avg&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;balance&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,<span class="attr">&quot;size&quot;</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>返回结果: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">1229</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">4</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;aggregations&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;ageAgg&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;doc_count_error_upper_bound&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;sum_other_doc_count&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;buckets&quot;</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">2</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">32</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">34.0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;balanceAvg&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">25208.0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>复杂的查询： </p>
<h5 id="按照年龄聚合-并且求这些年龄段的人的平均薪资"><a href="#按照年龄聚合-并且求这些年龄段的人的平均薪资" class="headerlink" title="按照年龄聚合,并且求这些年龄段的人的平均薪资"></a>按照年龄聚合,并且求这些年龄段的人的平均薪资</h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match_all&quot;</span>: &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;ageAgg&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;age&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;size&quot;</span>: <span class="number">100</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;ageAvg&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;avg&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;balance&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;size&quot;</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>返回结果: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;took&quot;</span> : <span class="number">3307</span>,</span><br><span class="line">  <span class="attr">&quot;timed_out&quot;</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;_shards&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;successful&quot;</span> : <span class="number">1</span>,</span><br><span class="line">    <span class="attr">&quot;skipped&quot;</span> : <span class="number">0</span>,</span><br><span class="line">    <span class="attr">&quot;failed&quot;</span> : <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;hits&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;value&quot;</span> : <span class="number">1000</span>,</span><br><span class="line">      <span class="attr">&quot;relation&quot;</span> : <span class="string">&quot;eq&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;max_score&quot;</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;aggregations&quot;</span> : &#123;</span><br><span class="line">    <span class="attr">&quot;ageAgg&quot;</span> : &#123;</span><br><span class="line">      <span class="attr">&quot;doc_count_error_upper_bound&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;sum_other_doc_count&quot;</span> : <span class="number">0</span>,</span><br><span class="line">      <span class="attr">&quot;buckets&quot;</span> : [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">31</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">61</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">28312.918032786885</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">39</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">60</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">25269.583333333332</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">26</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">59</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">23194.813559322032</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">32</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">52</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">23951.346153846152</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">35</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">52</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">22136.69230769231</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">36</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">52</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">22174.71153846154</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">22</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">51</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">24731.07843137255</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">28</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">51</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">28273.882352941175</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">33</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">50</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">25093.94</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">34</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">49</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">26809.95918367347</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">30</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">47</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">22841.106382978724</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">21</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">46</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">26981.434782608696</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">40</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">45</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">27183.17777777778</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">20</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">44</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">27741.227272727272</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">23</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">42</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">27314.214285714286</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">24</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">42</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">28519.04761904762</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">25</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">42</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">27445.214285714286</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">37</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">42</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">27022.261904761905</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">27</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">39</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">21471.871794871793</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">38</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">39</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">26187.17948717949</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;key&quot;</span> : <span class="number">29</span>,</span><br><span class="line">          <span class="attr">&quot;doc_count&quot;</span> : <span class="number">35</span>,</span><br><span class="line">          <span class="attr">&quot;ageAvg&quot;</span> : &#123;</span><br><span class="line">            <span class="attr">&quot;value&quot;</span> : <span class="number">29483.14285714286</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="查询所有年龄分布-并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资"><a href="#查询所有年龄分布-并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资" class="headerlink" title="查询所有年龄分布,并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资"></a>查询所有年龄分布,并且这些年龄段中M的平均薪资和F的平均薪资以及这个年龄段的总体平均薪资</h5><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">GET bank/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;query&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;match_all&quot;</span>: &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;ageAgg&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;age&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;size&quot;</span>: <span class="number">100</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;genderAgg&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;terms&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;gender.keyword&quot;</span></span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="attr">&quot;aggs&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;balanceAvg&quot;</span>: &#123;</span><br><span class="line">              <span class="attr">&quot;avg&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;balance&quot;</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;ageBalanceAvg&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;avg&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;field&quot;</span>: <span class="string">&quot;balance&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;size&quot;</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>返回结果： </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;_shards&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;failed&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;skipped&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;successful&quot;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">&quot;total&quot;</span>: <span class="number">1</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;aggregations&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;ageAgg&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;buckets&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ageBalanceAvg&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;value&quot;</span>: <span class="number">28312.918032786885</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">&quot;doc_count&quot;</span>: <span class="number">61</span>,</span><br><span class="line">                    <span class="attr">&quot;genderAgg&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;buckets&quot;</span>: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="attr">&quot;balanceAvg&quot;</span>: &#123;</span><br><span class="line">                                    <span class="attr">&quot;value&quot;</span>: <span class="number">29565.628571428573</span></span><br><span class="line">                                &#125;,</span><br><span class="line">                                <span class="attr">&quot;doc_count&quot;</span>: <span class="number">35</span>,</span><br><span class="line">                                <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;M&quot;</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="attr">&quot;balanceAvg&quot;</span>: &#123;</span><br><span class="line">                                    <span class="attr">&quot;value&quot;</span>: <span class="number">26626.576923076922</span></span><br><span class="line">                                &#125;,</span><br><span class="line">                                <span class="attr">&quot;doc_count&quot;</span>: <span class="number">26</span>,</span><br><span class="line">                                <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;F&quot;</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        ],</span><br><span class="line">                        <span class="attr">&quot;doc_count_error_upper_bound&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;sum_other_doc_count&quot;</span>: <span class="number">0</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">&quot;key&quot;</span>: <span class="number">31</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ageBalanceAvg&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;value&quot;</span>: <span class="number">25269.583333333332</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">&quot;doc_count&quot;</span>: <span class="number">60</span>,</span><br><span class="line">                    <span class="attr">&quot;genderAgg&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;buckets&quot;</span>: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="attr">&quot;balanceAvg&quot;</span>: &#123;</span><br><span class="line">                                    <span class="attr">&quot;value&quot;</span>: <span class="number">26348.684210526317</span></span><br><span class="line">                                &#125;,</span><br><span class="line">                                <span class="attr">&quot;doc_count&quot;</span>: <span class="number">38</span>,</span><br><span class="line">                                <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;F&quot;</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="attr">&quot;balanceAvg&quot;</span>: &#123;</span><br><span class="line">                                    <span class="attr">&quot;value&quot;</span>: <span class="number">23405.68181818182</span></span><br><span class="line">                                &#125;,</span><br><span class="line">                                <span class="attr">&quot;doc_count&quot;</span>: <span class="number">22</span>,</span><br><span class="line">                                <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;M&quot;</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        ],</span><br><span class="line">                        <span class="attr">&quot;doc_count_error_upper_bound&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;sum_other_doc_count&quot;</span>: <span class="number">0</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">&quot;key&quot;</span>: <span class="number">39</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;ageBalanceAvg&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;value&quot;</span>: <span class="number">23194.813559322032</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">&quot;doc_count&quot;</span>: <span class="number">59</span>,</span><br><span class="line">                    <span class="attr">&quot;genderAgg&quot;</span>: &#123;</span><br><span class="line">                        <span class="attr">&quot;buckets&quot;</span>: [</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="attr">&quot;balanceAvg&quot;</span>: &#123;</span><br><span class="line">                                    <span class="attr">&quot;value&quot;</span>: <span class="number">25094.78125</span></span><br><span class="line">                                &#125;,</span><br><span class="line">                                <span class="attr">&quot;doc_count&quot;</span>: <span class="number">32</span>,</span><br><span class="line">                                <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;M&quot;</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                <span class="attr">&quot;balanceAvg&quot;</span>: &#123;</span><br><span class="line">                                    <span class="attr">&quot;value&quot;</span>: <span class="number">20943.0</span></span><br><span class="line">                                &#125;,</span><br><span class="line">                                <span class="attr">&quot;doc_count&quot;</span>: <span class="number">27</span>,</span><br><span class="line">                                <span class="attr">&quot;key&quot;</span>: <span class="string">&quot;F&quot;</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        ],</span><br><span class="line">                        <span class="attr">&quot;doc_count_error_upper_bound&quot;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="attr">&quot;sum_other_doc_count&quot;</span>: <span class="number">0</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">&quot;key&quot;</span>: <span class="number">26</span></span><br><span class="line">                &#125;</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">&quot;doc_count_error_upper_bound&quot;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;sum_other_doc_count&quot;</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;hits&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;hits&quot;</span>: [],</span><br><span class="line">        <span class="attr">&quot;total&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;relation&quot;</span>: <span class="string">&quot;eq&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;value&quot;</span>: <span class="number">1000</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;timed_out&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">&quot;took&quot;</span>: <span class="number">34</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Elasticsearch%E4%B9%8B%E5%9F%BA%E6%9C%ACAPI/" rel="prev" title="Elasticsearch之基本API">
      <i class="fa fa-chevron-left"></i> Elasticsearch之基本API
    </a></div>
      <div class="post-nav-item">
    <a href="/Elasticserarch%E5%92%8Ckibana%E7%9A%84%E5%AE%89%E8%A3%85/" rel="next" title="Elasticserarch和kibana的安装">
      Elasticserarch和kibana的安装 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Elasticsearch%E4%B9%8B%E6%A3%80%E7%B4%A2"><span class="nav-number">1.</span> <span class="nav-text">4. Elasticsearch之检索</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E6%A3%80%E7%B4%A2"><span class="nav-number">1.1.</span> <span class="nav-text">4. 检索</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E6%A0%B7%E6%9C%AC%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE"><span class="nav-number">1.1.1.</span> <span class="nav-text">4.1 样本测试数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E6%A3%80%E7%B4%A2"><span class="nav-number">1.1.2.</span> <span class="nav-text">4.2 检索</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-1-search-api"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">4.2.1 search api</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-Query-DSL"><span class="nav-number">1.1.3.</span> <span class="nav-text">4.3 Query DSL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%E6%A0